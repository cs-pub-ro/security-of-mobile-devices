# Mobile Malware

Malware is software that is intended to cause harm.
This is in contrast with vulnerable software which may not be intended to cause harm by the initial author;
rather, due to configuration or development issues and weaknesses, it could be exploited.
The effect is the same: unwelcomed, abusive behavior aimed at the user data, workflow and devices.

## Malware Samples

Malware samples can be downloaded and used for research, analysis, evaluation of tools.
Sample locations are [Abuse Bazaar](https://bazaar.abuse.ch/) or [VirusTotal](https://www.virustotal.com/).

You can extract mobile malware from [AndroZoo](https://androzoo.uni.lu/) or from the [Drebin Dataset](https://drebin.mlsec.org/).

## Mobile Malware Analysis

There are plenty of malware analysis tools, as shown [here](https://github.com/joesecurity/awesome-malware-analysis/blob/master/README.md).

You can also use mobile analysis items such as those from the previous labs: [JADX](https://github.com/skylot/jadx), [Frida]().

As with others, malware analysis can be static or dynamic.

## Tasks

### 1. Download Malware Samples

Download 3 mobile malware samples from [Abuse Bazaar](https://bazaar.abuse.ch/).

Download 3 mobile malware samples from [AndroZoo](https://androzoo.uni.lu/) and 3 from the [Drebin Dataset](https://drebin.mlsec.org/).

Use the instructions below for [AndroZoo](https://androzoo.uni.lu/) and [Drebin](https://drebin.mlsec.org/).

#### AndroZoo

Use the API key `465e1448f338425b757c441111fc2c06cd2bcb8b1e2146100bf0db6aa801a541`.

Documentation for the API is available at https://androzoo.uni.lu/api_doc

#### Drebin

> [!NOTE]
> At this point, we don't have access to the Drebin test suite.
> Go past this task, at this point.

- url: https://www.sec.cs.tu-bs.de/~danarp/drebin/download.html
- login: `drebin`
- password: `h9FN43vH`

The password for the zip files is `infected`.

### 2. Submit Malware Samples to Online Services

Submit downloaded / selected malware samples and submit them to online services to check for malicious behavior and detect them.

- https://www.virustotal.com/gui/home/upload
- https://mars.trendmicro.com/

### 3. Malware Analysis

Analyze the following malware samples using online services and static analysis tools.

#### Android Malware

See [here](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/android-malware) general information on Android malware.

Examples:

- [Exobot](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/android-malware/exo-exobot) (download from [Malware Bazaar](https://bazaar.abuse.ch/browse/tag/Exobot/))
- Fireweyr (download from [Malware Bazaar](https://bazaar.abuse.ch/sample/a860621ca11cd660118a4127c12e91b64f3dca7caea137b2a15b39001184b203/))
- ViperRAT (download from [Malware Bazaar](https://www.virustotal.com/gui/file/1df407206dd8f1a292f8c168e5939df27606d2c9ff552fc2d0fdef8197fee99e))
- [XLoader](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/android-malware/xloader) (download from [Malware Bazaar](https://bazaar.abuse.ch/browse/tag/xloader/))

#### iOS Malware

See [here](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/ios-malware) general information on iOS malware.

Examples:

- [Pegasus](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/ios-malware/pegasus) (download from [Malware Bazaar](https://bazaar.abuse.ch/browse/tag/Pegasus/) or [9aylas/Pegasus-samples](https://github.com/9aylas/Pegasus-samples))
- [Wirelurker](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/ios-malware/wirelurker) (download from [VirusTotal](https://www.virustotal.com/gui/file/7d3acad83a132dd2f52928122ad783693e87de07322e022e09199428a9399214/detection))
- [XcodeGhost](https://www.cyber.nj.gov/threat-landscape/malware/mobile-malware/ios-malware/xcodeghost) (download from [VirusTotal](https://www.virustotal.com/gui/file/b1f567afbf02b6993a1ee96bfdb9c54010a1ad732ab53e5149dda278dd06c979))

## Other Resources

- [Android](https://github.com/DroidHook/DroidHook-XposedModule/)
- [iOS](https://8ksec.io/mobile-malware-analysis-part-4-intro-to-ios-malware-detection/)
- [Android (requires cloud pro trial)](https://joesecurity.org/blog/1550862857627896026)

Additional analyzers:

- [Kaspersky Threat Intelligence Portal â€” Analysis](https://opentip.kaspersky.com/)
- [VirusShare.com](https://virusshare.com/)
- [Login | Triage](https://tria.ge/)
- https://analyze.neiki.dev/
- https://www.capesandbox.com

Tutorials:

- [Malware development course: Maldev Academy](https://maldevacademy.com/)
- [iOS pentesting](https://github.com/darklotuskdb/ios-buster)
- [Android App Reverse Engineering 101](https://www.ragingrock.com/AndroidAppRE/)
